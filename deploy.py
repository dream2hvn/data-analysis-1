# -*- coding: utf-8 -*-
"""deploy.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1duUpFilMdbui4_R1IZG8_t5LF6ff62no
"""
"""# **Pack**"""

import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt
import folium
from folium.plugins import MarkerCluster
import seaborn as sns

# Judul Dashboard
st.title("Dashboard Analisis E-commerce")

# Menghitung RFM
rfm_df = calculate_rfm(orders_df, customers_df, order_items_df)

# Menampilkan judul aplikasi
st.title('Visualisasi RFM Analysis')

# Pilihan visualisasi yang tersedia
visualization_type = st.sidebar.selectbox(
    'Pilih jenis visualisasi',
    ('Histogram', 'Scatter Plot', 'Heatmap Korelasi')
)

# Menampilkan visualisasi sesuai pilihan pengguna
if visualization_type == 'Histogram':
    st.subheader('Histogram untuk Variabel RFM')

    # Pilihan variabel untuk ditampilkan
    variable = st.selectbox('Pilih variabel', ('recency', 'frequency', 'total_spent'))

    # Membuat histogram
    fig, ax = plt.subplots()
    sns.histplot(rfm_df[variable], bins=30, kde=True, ax=ax)
    ax.set_title(f'Distribusi {variable}')
    st.pyplot(fig)

elif visualization_type == 'Scatter Plot':
    st.subheader('Scatter Plot untuk Variabel RFM')

    # Pilihan variabel X dan Y
    x_axis = st.selectbox('Pilih variabel X', ('recency', 'frequency', 'total_spent'))
    y_axis = st.selectbox('Pilih variabel Y', ('recency', 'frequency', 'total_spent'))

    # Membuat scatter plot
    fig, ax = plt.subplots()
    sns.scatterplot(x=rfm_df[x_axis], y=rfm_df[y_axis], ax=ax)
    ax.set_title(f'Scatter Plot antara {x_axis} dan {y_axis}')
    st.pyplot(fig)

elif visualization_type == 'Heatmap Korelasi':
    st.subheader('Heatmap Korelasi antara Variabel RFM')

    # Menghitung matriks korelasi
    corr_rfm = rfm_df[['recency', 'frequency', 'total_spent']].corr()

    # Membuat heatmap
    fig, ax = plt.subplots()
    sns.heatmap(corr_rfm, annot=True, cmap='coolwarm', vmin=-1, vmax=1, ax=ax)
    ax.set_title('Correlation Matrix for RFM')
    st.pyplot(fig)
